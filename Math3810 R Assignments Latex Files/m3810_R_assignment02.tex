\documentclass[11pt]{article}
\usepackage[suffix=Solutions]{teaching-header}
\usepackage{listings,tikz,enumitem,booktabs}

\lstdefinelanguage{R}{
      keywords={if,else,while,for,in,next,break,function,TRUE,FALSE,NULL,Inf,NA,NaN,switch,repeat,return,require,library},
      keywordstyle=\color{blue}\bfseries,
      identifierstyle=\color{black},
      comment=[l]{\#},
      commentstyle=\color{gray}\ttfamily,
      string=[b]{"},
      stringstyle=\color{red}\ttfamily,
      morecomment=[l]{//},
      morestring=[b]{'},
      sensitive=true,
      morekeywords={print,summary,plot,lm,glm,data,frame,read.csv,write.csv,factor,levels,names,colnames,rownames,
      head,tail,str,dim,length,class,typeof,mode,is.na,is.null,is.finite,is.infinite,is.nan,as.numeric,as.character,
      as.factor,as.Date,as.POSIXct,as.matrix,as.data.frame,rbind,cbind,merge,subset,aggregate,tapply,apply,lapply,sapply,
      mapply,vapply,replicate,seq,rep,c,list,matrix,array,data.frame,table,hist,boxplot,barplot,pie,curve,lines,points,text,
      abline,legend,par,mtext,title,xlab,ylab,xlim,ylim,main,sub,col,pch,cex,lty,lwd,type,bg,fg,args,options,warnings,errors,
      message,stop,warning,error,try,tryCatch,withCallingHandlers,on.exit,debug,browser,trace,recover,options,getOption,setOption},
    }

% Assessment specific definitions
\def\assessmenttype{introductory homework}
\def\assessmenttypecap{Introductory Homework}
\def\assessmentname{\#2}  
\def\assessmentnamesol{\#2 Solutions}
\def\duedate{Wednesday, September 25}
\def\duetime{3:30pm}
\def\printfancyheader{1} 

\input{classinfo}

\ifnum\printfancyheader=1
\pagestyle{myheadings}
\else
    \ifnum\printsol=0
        \pagestyle{empty}
    \else
        \pagestyle{plain}
    \fi
\fi

\ifnum\printsol=0
\title{\vspace{-1in}Math\classnum\;-\;\classtitle\\
    Section\;\classsec\;-\;\classterm\\
    \assessmenttypecap\;\assessmentname}
\author{University of Colorado Denver / College of Liberal Arts and Sciences}
\date{Department of Mathematics - \instructor}
\markright{Math\classnum\;-\;\classtitle,\;\assessmenttypecap\;\assessmentname, UCD, \classterm, \instructor}
\else
\title{\vspace{-1in}Math\classnum\;-\;\classtitle\\
    Section\;\classsec\;-\;\classterm\\
    \assessmenttypecap\;\assessmentnamesol}
\author{University of Colorado Denver / College of Liberal Arts and Sciences}
\date{Department of Mathematics - \instructor}
\markright{Math\classnum\;-\;\classtitle,\;\assessmenttypecap\;\assessmentname, UCD, \classterm, \instructor}
\fi

\begin{document}
\ifnum\printfancyheader=1
\maketitle\thispagestyle{empty}
\else
    \ifnum\printsol=0
        \begin{center}{\large Math \classnum--\classsec, UCD, \classterm, Homework \assessmentname}\\
        \smallskip
        Due by \duedate\, at \duetime.\\
        \smallskip
        {\em Late homeworks will not be accepted without prior approval. Please no email submissions!}
        \end{center}
    \else
        \begin{center}{Math \classnum--\classsec, UCD, \classterm \hfill Homework \assessmentnamesol}
        \end{center}
        \vskip 2mm
    \fi
\hrule
\vskip 5mm
\fi

\normalsize

\ifnum\printsol=0
\hrule\bigskip\noindent\textbf{Name:}\hspace*{3in}
\textbf{Student Number:}\bigskip\hrule
\vspace*{5mm}
\begin{itemize}\itemsep=0in
    \item This is an open note \assessmenttype. You may use your notes and your book.
    \item Show your work clearly.
    \item Table for total points:
\begin{center}
{\renewcommand{\arraystretch}{1.5}
\renewcommand{\tabcolsep}{0.2cm}
\begin{tabular}{||c||c||c||}
\hline
Problem & Points & Score/10 \\ \hline \hline
1 & 10 & \hspace{1.0in} \\ \hline
2 & 12 & \hspace{1.0in} \\ \hline
3 & 8 & \hspace{1.0in} \\ \hline
4 & 10 & \hspace{1.0in} \\ \hline
5 & 5 & \hspace{1.0in} \\ \hline
Total & 45 & \hspace{1.0in} \\ \hline
\end{tabular}}
\end{center}
\end{itemize}
\vspace*{5mm}
\begin{flushright}
Total Score:\;\underline{\hspace*{2cm}}\;/\;10
\end{flushright}
\vfill\eject
\fi

\renewcommand{\S}{\mathbb{S}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\prob}[1]{\mathbb{P}\left(#1\right)}
\newcommand{\Prob}[1]{\mathbb{P}\Big(#1\Big)}

\ifnum\printsol=1
\vspace*{2mm}
\hrule
\vskip 8mm
\fi

\section*{Instructions}
Show all reasoning clearly. All simulation results should be reproducible and clearly labeled.
You may use R for all computations.

\section*{Problems}
\begin{enumerate}[leftmargin=*]

\item \textbf{Vector and Sequence Operations}
\begin{enumerate}
\item Create a numeric vector containing the numbers 1 through 10.
\item Compute the sum and mean of the vector.
\item Create a sequence from 0 to 5 in increments of 0.5.
\item Compute the sum of the squares of this sequence.
\end{enumerate}

\item \textbf{Simulating Two Dice Rolls}
\begin{enumerate}
\item Simulate a single roll of two fair six-sided dice.
\item Simulate 1000 rolls of two dice.
\item Compute the proportion of times the sum is 7.
\item Compare your result to the theoretical probability.
\end{enumerate}

\item \textbf{Empirical Distribution of a Die}
\begin{enumerate}
\item Simulate 600 rolls of a fair six-sided die.
\item Compute the empirical probability of each face.
\item Create a barplot of the frequencies.
\item Compare the empirical probabilities to the theoretical probability of \(1/6\) for each face.
\end{enumerate}

\item \textbf{Simulating a Biased Coin}
\begin{enumerate}
\item Simulate 100 coin tosses where \(P(\text{Heads})=0.7\).
\item Compute the proportion of heads and tails.
\item Repeat this simulation three times and observe the variation.
\item Discuss why the results differ slightly across trials.
\end{enumerate}

\item \textbf{Conceptual Question}
In your own words, explain:
\begin{itemize}
\item The difference between theoretical and empirical probabilities,
\item Why simulations can be used to estimate probabilities,
\item How increasing the number of trials affects the estimates.
\end{itemize}

\end{enumerate}

\ifnum\printsol=1
\section*{Solutions}
\begin{enumerate}[leftmargin=*]

\item
\begin{lstlisting}[language=R]
v <- 1:10
sum(v)
mean(v)

seq1 <- seq(0, 5, by = 0.5)
sum(seq1^2)
\end{lstlisting}

\item
\begin{lstlisting}[language=R]
roll <- sample(1:6, 2, replace = TRUE)

rolls <- replicate(1000, sum(sample(1:6, 2, replace = TRUE)))
mean(rolls == 7)
\end{lstlisting}
Theoretical probability: \(6/36 = 1/6 \approx 0.1667\).

\item
\begin{lstlisting}[language=R]
rolls <- sample(1:6, 600, replace = TRUE)
table(rolls) / 600
barplot(table(rolls), col = "skyblue", main = "Empirical Frequencies of Die Faces")
\end{lstlisting}
Theoretical probability for each face: \(1/6 \approx 0.1667\).

\item
\begin{lstlisting}[language=R]
coin <- sample(c("H","T"), 100, replace = TRUE, prob = c(0.7, 0.3))
mean(coin == "H")
mean(coin == "T")

for(i in 1:3){
  coin <- sample(c("H","T"), 100, replace = TRUE, prob = c(0.7,0.3))
  print(mean(coin == "H"))
}
\end{lstlisting}
Results differ slightly due to random variation.

\item
Simulations approximate theoretical probabilities.  
Empirical probabilities vary because each trial is random.  
Increasing the number of trials reduces variation, stabilizing estimates near theoretical values.

\end{enumerate}

\vskip 5mm
\hrule
\vskip 5mm
\begin{center}
\bf Please let me know if you have any questions, comments, or corrections!
\end{center}
\fi

\end{document}
